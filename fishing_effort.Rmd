---
title: "fishing_effort"
author: "Juliet"
date: "11/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(here)
library(tidyverse)
library(janitor)
library(lubridate)
```

```{r}
data = read_csv(here('data', 'fishing-vessels-v2.csv'))
```
```{r}
nrow_raw = nrow(data)
nrow_raw

# filter for only rows that have fishing hours for both 2019 and 2020
data_2019_2020 <- data %>% 
  filter(fishing_hours_2019 != "NA" & fishing_hours_2020 != "NA")

nrow_2019_2020 = nrow(data_2019_2020)
nrow_2019_2020

num_rows_lost = nrow_raw - nrow_2019_2020
num_rows_lost
```

```{r}
# compare the amount and identity of countries in the raw data to the amount and identiity of the countries in the subset
num_countries_raw = (unique(data$flag_gfw))
num_countries_raw

unique(data_2019_2020$flag_gfw)
```
2019 Fishing Effort Data

```{r}
data_2019_country <- aggregate(data_2019_2020$fishing_hours_2019, by=list(country=data_2019_2020$flag_gfw), FUN=sum)

max_country_2019 = data_2019_country %>% 
  filter(x == 16580833.42)

country_graph <- ggplot(data_2019_country, aes(x = country, y = x)) +
  geom_point()

country_graph

```

2020 Fishing Effort Data

```{r}
data_2020_country <- aggregate(data_2019_2020$fishing_hours_2020, by=list(country=data_2019_2020$flag_gfw), FUN=sum)

max(data_2020_country$x)

max_country_2020 = data_2020_country %>% 
  filter(x == 15904523.46)

max_country_2020

country_graph <- ggplot(data_2020_country, aes(x = country, y = x)) +
  geom_point()

country_graph
```

Boat Data

```{r}
#unique(data$vessel_class_registry)
# there's a lot of types, and many rows have multiple suggestions for the boat(s) types

boat_data <- data %>% 
  filter( vessel_class_registry == c('trawlers', 'tuna_purse_seines', 'fishing'))

# tonnage by country
boat_tonnage_country <- aggregate(boat_data$tonnage_gt_gfw, by=list(country=boat_data$flag_gfw), FUN=mean)

max(boat_tonnage_country$x, na.rm = TRUE)

min(boat_tonnage_country$x, na.rm = TRUE)

boat_tonnage_country_max = boat_tonnage_country %>% 
  filter(x == 4407)
# country VCT: Saint Vincent and the Grenadines ?

boat_tonnage_country_min = boat_tonnage_country %>% 
  filter(x == 28.96)
# country SVN: slovenia
```

```{r}

```



















